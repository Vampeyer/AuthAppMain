<!DOCTYPE html>
<html>
<head>
  <title>API TEST PAGE</title>
  <style>body{font-family:Arial;padding:20px;} pre{background:#f0f0f0;padding:10px;}</style>
</head>
<body>
  <h1>API TESTER</h1>
  <button onclick="testAll()">TEST ALL ENDPOINTS</button>
  <pre id="log"></pre>

  <script>
    const BACKEND = 'https://authappmain.onrender.com';
    const log = (msg) => document.getElementById('log').innerHTML += msg + '\n';

    async function testAll() {
      log('=== TESTING API ENDPOINTS ===\n');
      log(`Backend: ${BACKEND}\n`);

      // Test 1: Root
      await fetch(BACKEND).then(r => log(`GET / → ${r.status} OK`)).catch(e => log(`GET / → FAILED: ${e.message}`));

      // Test 2: Signup
      await fetch(`${BACKEND}/api/signup`, {
        method: 'POST',
        credentials: 'include',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username: 'test' + Date.now(), email: 'test@example.com', password: '123456' })
      })
      .then(r => r.json())
      .then(d => log(`Signup → ${d.success ? 'SUCCESS (phrase generated)' : 'FAILED: ' + (d.error || 'unknown')}`))
      .catch(e => log(`Signup → CORS ERROR: ${e.message}`));

      // Test 3: Login (will fail without real user, but shows CORS works)
      await fetch(`${BACKEND}/api/login`, {
        method: 'POST',
        credentials: 'include',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username: 'test', password: '123456', phrase: 'wrong' })
      })
      .then(r => log(`Login → ${r.status === 401 ? 'CORS WORKS (401 expected)' : 'PROBLEM'}`))
      .catch(e => log(`Login → CORS ERROR: ${e.message}`));

      log('\n=== TEST COMPLETE ===');
    }
  </script>
</body>
</html>