<script>
const BACKEND_URL = 'https://authappmain.onrender.com';
const token = localStorage.getItem('jwt');

async function load() {
  if (!token) {
    document.getElementById('content').innerHTML = 'Not logged in → <a href="login.html">Login</a>';
    return;
  }

  const res = await fetch(`${BACKEND_URL}/api/me`, {
    headers: { 'Authorization': `Bearer ${token}` }
  });

  if (!res.ok) {
    localStorage.removeItem('jwt');
    document.getElementById('content').innerHTML = 'Session expired → <a href="login.html">Login</a>';
    return;
  }

  const u = await res.json();
  // ... rest of your profile display
}

function buy(priceId) {
  fetch(`${BACKEND_URL}/api/create-checkout-session`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`
    },
    body: JSON.stringify({ price_id: priceId })
  })
  .then(r => r.json())
  .then(d => d.url && (location.href = d.url));
}

function logout() {
  localStorage.removeItem('jwt');
  location.href = 'login.html';
}

load();
</script>